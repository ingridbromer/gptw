package com.gptw.service;

import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.kafka.core.KafkaTemplate;
import org.springframework.kafka.support.KafkaHeaders;
import org.springframework.messaging.Message;
import org.springframework.messaging.support.MessageBuilder;
import org.springframework.stereotype.Service;

import com.gptw.config.AppConfigProperties;
import com.gptw.model.Employee;


	@Service
	public class KafkaPublisherService {
		
		@Autowired
		private KafkaTemplate<String, Employee> kafkaTemplate;

		private static final Logger LOG=LoggerFactory.getLogger(KafkaPublisherService.class);
		
		@Autowired
		 private AppConfigProperties appConfig;
	   
		
		public void publish(Employee employee) {
			LOG.info("Sending '{}' to topic = '{}' ",employee,appConfig.getOutputKafkaTopic());
			Message<Employee> message=MessageBuilder.withPayload(employee).setHeader(KafkaHeaders.TOPIC, "employee").build();
			kafkaTemplate.send(message);
		}
		
}
